<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="initial-scale=1.0,user-scalable=no">
    <title>現在地の表示</title>
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type="text/javascript">
        function initialize(){
            if (typeof(navigator.geolocation) != 'undefined') {
                navigator.geolocation.watchPosition(success, error);
            }
        }
        function success(position){
            var lat = position.coords.latitude;
            var lng = position.coords.longitude;
            
            var msg = document.getElementById("msg");
            msg.innerHTML = "あなたの現在地を表示" + "<div>緯度:" + lat + "<br/>" + " 経度:" + lng + "</div>" + "<div>" + (new Date()).toString() + "</div>";
            
            var latlng = new google.maps.LatLng(lat, lng);
            var myOptions = {
                zoom: 16,
                center: latlng,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var googlemap = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
            var marker = new google.maps.Marker({
                position: latlng,
                map: googlemap
            });
        }
        function error(e){
            alert("エラーが発生しました - " + e.message);
        }        
    </script>    
  </head>
  <body onload="initialize()">
      <div id="msg"></div>      
    <div id="map_canvas" style="width:600px; height:320px;"></div>
  </body>
</html>